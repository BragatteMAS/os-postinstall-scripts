---
phase: 14-testing-documentation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
autonomous: true

must_haves:
  truths:
    - "README.md Customization section documents EXTRA_PACKAGES environment variable with usage example"
    - "README.md Customization section documents SKIP_PACKAGES environment variable with usage example"
    - "README.md includes a Windows Troubleshooting section covering execution policy"
    - "README.md includes a Windows Troubleshooting section covering WinGet availability"
    - "README.md includes a Windows Troubleshooting section covering PATH issues after WinGet installs"
  artifacts:
    - path: "README.md"
      provides: "EXTRA_PACKAGES and SKIP_PACKAGES documentation in Customization section; Windows Troubleshooting subsections"
      contains: "EXTRA_PACKAGES"
  key_links:
    - from: "README.md Customization section"
      to: "config.sh lines 36-41"
      via: "documents EXTRA_PACKAGES and SKIP_PACKAGES arrays"
      pattern: "EXTRA_PACKAGES"
    - from: "README.md Troubleshooting section"
      to: "setup.ps1 line 4"
      via: "documents -ExecutionPolicy Bypass pattern"
      pattern: "ExecutionPolicy"
---

<objective>
Add two documentation sections to README.md: (1) EXTRA_PACKAGES and SKIP_PACKAGES documentation in the Customization section, and (2) a Windows Troubleshooting section covering execution policy, WinGet availability, and PATH issues.

Purpose: Users currently have no README guidance on EXTRA_PACKAGES/SKIP_PACKAGES (declared in config.sh but undocumented) and only one Windows troubleshooting item. These gaps were identified by the v3.0 expert review.

Output: Updated README.md with 2 new documentation sections.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-testing-documentation/14-RESEARCH.md
@README.md
@config.sh
@setup.ps1
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add EXTRA_PACKAGES and SKIP_PACKAGES documentation to README Customization section</name>
  <files>README.md</files>
  <action>
In README.md, find the Customization section (around line 417). After the "Creating a custom profile" subsection (after line 439 `Then run: ./setup.sh custom`) and BEFORE the "Adding dotfiles" subsection, insert a new subsection:

```markdown
### Environment variables

Two arrays in `config.sh` allow per-run customization without editing package files:

| Variable | Type | Default | Description |
|----------|------|---------|-------------|
| `EXTRA_PACKAGES` | Bash array | `()` | Additional packages appended to the profile's package list |
| `SKIP_PACKAGES` | Bash array | `()` | Packages to exclude even if listed in the profile |

**Usage:**

```bash
# Install extra packages alongside your profile
EXTRA_PACKAGES=(neovim tmux) ./setup.sh

# Skip specific packages from the profile
SKIP_PACKAGES=(kite snapd) ./setup.sh

# Combine both
EXTRA_PACKAGES=(neovim) SKIP_PACKAGES=(snapd) ./setup.sh
```

> **Note:** These variables are declared in `config.sh` (lines 36-41) as hooks for customization. Currently, no installer reads them automatically -- they serve as a configuration point for users who source `config.sh` in custom scripts or for future installer integration.
```

IMPORTANT: The documentation must be honest about the current state. Per research finding (Pitfall 6), EXTRA_PACKAGES and SKIP_PACKAGES are declared but no installer consumes them. The "Note" paragraph handles this honestly without misleading users. Do NOT claim they work automatically. Do NOT implement consumption logic -- this is documentation only.

Keep the rest of the Customization section unchanged.
  </action>
  <verify>
    ```bash
    grep -n 'EXTRA_PACKAGES' README.md
    grep -n 'SKIP_PACKAGES' README.md
    grep -n 'Environment variables' README.md
    ```
    All three should return matches in the Customization section area.
    Verify the honest Note about current state is present:
    ```bash
    grep -n 'no installer reads them automatically' README.md
    ```
  </verify>
  <done>
    README.md Customization section contains a new "Environment variables" subsection documenting EXTRA_PACKAGES and SKIP_PACKAGES with a table, usage examples, and an honest note about current integration status. Users can discover these config hooks and understand their current scope.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Windows Troubleshooting sections to README</name>
  <files>README.md</files>
  <action>
In README.md, find the Troubleshooting section (around line 517). Currently there is one Windows item: "WinGet not recognized on Windows" (lines 575-582). Add two more Windows troubleshooting items AFTER the existing WinGet item and BEFORE the "Uninstall / Restore" section (line 584).

**Item 1: Execution policy** -- Insert after the WinGet `</details>` closing tag:

```markdown
<details>
<summary><b>PowerShell execution policy on Windows</b></summary>

**Problem:** `.\setup.ps1 : File .\setup.ps1 cannot be loaded because running scripts is disabled on this system.`

**Solution:** Windows restricts script execution by default. Run one of:

```powershell
# Option 1: Bypass for this session only (recommended)
powershell -ExecutionPolicy Bypass -File .\setup.ps1

# Option 2: Allow scripts permanently for current user
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
.\setup.ps1
```

The `-ExecutionPolicy Bypass` flag is the safest option as it only affects the current invocation.

</details>
```

**Item 2: PATH issues after WinGet installs** -- Insert after the execution policy item:

```markdown
<details>
<summary><b>PATH not updated after WinGet install on Windows</b></summary>

**Problem:** A package installed via WinGet is not found when you run it immediately after installation.

**Solution:** WinGet modifies the system PATH, but the current PowerShell session does not pick up changes automatically. Either:

1. **Close and reopen PowerShell** (simplest)
2. **Refresh PATH in the current session:**
   ```powershell
   $env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")
   ```

This is a Windows limitation, not a script issue. The same applies to any installer that modifies PATH (Cargo, npm, etc.).

</details>
```

Keep the existing "WinGet not recognized" item unchanged. The three Windows items should appear in this order:
1. WinGet not recognized (existing)
2. PowerShell execution policy (new)
3. PATH not updated after WinGet install (new)

Do NOT modify any other Troubleshooting items.
  </action>
  <verify>
    ```bash
    grep -n 'execution policy' README.md
    grep -n 'ExecutionPolicy' README.md
    grep -n 'PATH not updated' README.md
    grep -n 'Troubleshooting' README.md
    ```
    Confirm: "execution policy" appears in the Troubleshooting section, "ExecutionPolicy" appears as the solution, "PATH not updated" appears as a new item. Count the `<details>` blocks in Troubleshooting -- should be 6 total (4 existing + 2 new).
  </verify>
  <done>
    README.md Troubleshooting section includes three Windows items: WinGet availability (existing), PowerShell execution policy (new), and PATH issues after WinGet installs (new). Each uses the existing collapsible `<details>` format with Problem/Solution structure. Coverage: execution policy bypass, WinGet availability, and PATH refresh after installs.
  </done>
</task>

</tasks>

<verification>
Phase 14 plan 02 (DOC-01 + DOC-02) verification:

1. `grep -c 'EXTRA_PACKAGES' README.md` returns at least 3 (variable name, table row, usage example)
2. `grep -c 'SKIP_PACKAGES' README.md` returns at least 3 (variable name, table row, usage example)
3. `grep -c 'ExecutionPolicy' README.md` returns at least 2 (problem description, solution)
4. `grep -c 'PATH not updated' README.md` returns at least 1
5. `grep -c '<details>' README.md` -- Troubleshooting section has 6+ collapsible blocks
6. `grep -q 'no installer reads them automatically' README.md` -- honest note about EXTRA_PACKAGES status
</verification>

<success_criteria>
- README.md Customization section has "Environment variables" subsection with EXTRA_PACKAGES and SKIP_PACKAGES table, examples, and honest status note
- README.md Troubleshooting section has 3 Windows items: WinGet availability, execution policy, PATH issues
- Execution policy section shows `-ExecutionPolicy Bypass` solution
- PATH issues section shows PATH refresh command
- All existing README content preserved unchanged
- Documentation is honest about EXTRA_PACKAGES/SKIP_PACKAGES not being consumed by installers
</success_criteria>

<output>
After completion, create `.planning/phases/14-testing-documentation/14-02-SUMMARY.md`
</output>
