---
phase: 15-data-compatibility-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - data/packages/flatpak.txt
  - data/packages/flatpak-post.txt
autonomous: true

must_haves:
  truths:
    - "All entries in flatpak.txt use valid reverse-DNS Flatpak IDs (0 short names)"
    - "All entries in flatpak-post.txt use valid reverse-DNS Flatpak IDs (0 short names)"
    - "TogglDesktop entry removed from flatpak-post.txt (discontinued, 404 on Flathub)"
    - "Skype entry removed from flatpak.txt (archived on Flathub July 2025)"
    - "Workflow entry removed from flatpak-post.txt (archived Dec 2023, removed from Flathub)"
  artifacts:
    - path: "data/packages/flatpak.txt"
      provides: "Corrected Flatpak package IDs for base install"
      contains: "com.github.tchx84.Flatseal"
    - path: "data/packages/flatpak-post.txt"
      provides: "Corrected Flatpak package IDs for post-install"
      contains: "com.github.tchx84.Flatseal"
  key_links:
    - from: "data/packages/flatpak.txt"
      to: "src/platforms/linux/install/flatpak.sh"
      via: "load_packages reads this file"
      pattern: "flatpak.txt"
    - from: "data/packages/flatpak-post.txt"
      to: "src/platforms/linux/install/flatpak.sh"
      via: "load_packages reads this file"
      pattern: "flatpak-post.txt"
---

<objective>
Fix all broken Flatpak application IDs in both package list files and remove discontinued apps.

Purpose: Flatpak requires full reverse-DNS application identifiers (e.g., `com.slack.Slack`). Short names like `slack` silently fail with `flatpak install`. 20 of 24 entries in flatpak.txt and 16 of 49 entries in flatpak-post.txt use invalid short names. Additionally, TogglDesktop (404 on Flathub), Skype (archived July 2025), and Workflow (archived Dec 2023, removed from Flathub) must be removed.

Output: Two corrected data files with 100% valid Flatpak IDs and no discontinued apps.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-data-compatibility-fixes/15-RESEARCH.md
@data/packages/flatpak.txt
@data/packages/flatpak-post.txt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Flatpak IDs and remove discontinued apps in flatpak.txt</name>
  <files>data/packages/flatpak.txt</files>
  <action>
Replace all 20 broken short-name entries with their correct reverse-DNS Flatpak IDs. Apply the following replacement map (verified against Flathub):

| Current | Correct ID |
|---------|------------|
| `flatseal` | `com.github.tchx84.Flatseal` |
| `filezilla` | `org.filezillaproject.Filezilla` |
| `vim.vim` | `org.vim.Vim` |
| `pavucontrol` | `org.pulseaudio.pavucontrol` |
| `obsproject.Studio` | `com.obsproject.Studio` |
| `zoom` | `us.zoom.Zoom` |
| `slack` | `com.slack.Slack` |
| `dropbox` | `com.dropbox.Client` |
| `masterpdf` | `net.code_industry.MasterPDFEditor` |
| `calibre` | `com.calibre_ebook.calibre` |
| `ankiweb` | `net.ankiweb.Anki` |
| `geogebra` | `org.geogebra.GeoGebra` |
| `openboard` | `ch.openboard.OpenBoard` |
| `blanket` | `com.rafaelmardojai.Blanket` |
| `organizer` | `org.librehunt.Organizer` |
| `meld` | `org.gnome.meld` |
| `gitkraken` | `com.axosoft.GitKraken` |
| `jamovi` | `org.jamovi.jamovi` |
| `Epiphany` | `org.gnome.Epiphany` |

Additionally:
- REMOVE the `skype` entry entirely (archived on Flathub July 2025). Add a comment: `# Skype (com.skype.Client) removed -- archived on Flathub July 2025`
- Keep entries that are already correct: `org.gnome.Boxes`, `org.blender.Blender`, `org.videolan.VLC`, `com.wps.Office`
- Preserve all existing comment lines and section structure
- Update the header comment to note that all IDs use full reverse-DNS format
  </action>
  <verify>
Run verification commands:
```bash
# Count non-comment, non-empty lines with fewer than 2 dots (should be 0)
grep -v '^#' data/packages/flatpak.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l

# Verify skype is removed
grep -i 'skype' data/packages/flatpak.txt | grep -v '^#' | wc -l

# Count total valid entries (should be ~22, was 24 minus 2 removed)
grep -v '^#' data/packages/flatpak.txt | grep -v '^$' | wc -l
```
  </verify>
  <done>All non-comment lines in flatpak.txt contain at least 2 dots (valid reverse-DNS). Skype entry removed. Total ~22 valid entries remain.</done>
</task>

<task type="auto">
  <name>Task 2: Fix Flatpak IDs and remove discontinued apps in flatpak-post.txt</name>
  <files>data/packages/flatpak-post.txt</files>
  <action>
Replace all 16 broken short-name entries with their correct reverse-DNS Flatpak IDs. Apply the following replacement map (verified against Flathub):

| Current | Correct ID |
|---------|------------|
| `flatseal` | `com.github.tchx84.Flatseal` |
| `filezilla` | `org.filezillaproject.Filezilla` |
| `gpuviewer` | `io.github.arunsivaramanneo.GPUViewer` |
| `OnionShare` | `org.onionshare.OnionShare` |
| `pavucontrol` | `org.pulseaudio.pavucontrol` |
| `obsproject.Studio` | `com.obsproject.Studio` |
| `zoom` | `us.zoom.Zoom` |
| `slack` | `com.slack.Slack` |
| `dropbox` | `com.dropbox.Client` |
| `calibre` | `com.calibre_ebook.calibre` |
| `openboard` | `ch.openboard.OpenBoard` |
| `fontfinder` | `io.github.mmstick.FontFinder` |
| `meld` | `org.gnome.meld` |
| `blanket` | `com.rafaelmardojai.Blanket` |
| `organizer` | `org.librehunt.Organizer` |
| `geogebra` | `org.geogebra.GeoGebra` |

Additionally:
- REMOVE the `com.toggl.TogglDesktop` entry entirely (discontinued, 404 on Flathub). Add a comment: `# TogglDesktop (com.toggl.TogglDesktop) removed -- discontinued, 404 on Flathub`
- REMOVE the `com.gitlab.cunidev.Workflow` entry entirely (archived Dec 2023, removed from Flathub). Add a comment: `# Workflow (com.gitlab.cunidev.Workflow) removed -- archived Dec 2023, 404 on Flathub`
- Keep all entries that are already correct (com.bitwarden.desktop, org.gnome.Boxes, de.haeckerfelix.Fragments, fr.romainvigier.MetadataCleaner, com.spotify.Client, org.audacityteam.Audacity, io.github.seadve.Mousai, com.uploadedlobster.peek, org.inkscape.Inkscape, org.kde.kdenlive, org.videolan.VLC, org.blender.Blender, com.valvesoftware.Steam, org.telegram.desktop, com.discordapp.Discord, com.google.Chrome, org.chromium.Chromium, io.gitlab.librewolf-community, nz.mega.MEGAsync, org.kde.okular, com.github.johnfactotum.Foliate, org.gustavoperedo.FontDownloader, io.github.lainsce.Colorway, io.github.lainsce.Emulsion, com.visualstudio.code, rest.insomnia.Insomnia, org.texstudio.TeXstudio, md.obsidian.Obsidian, org.zotero.Zotero, org.pymol.PyMOL, org.jaspstats.JASP)
- Preserve all existing comment lines and section structure
  </action>
  <verify>
Run verification commands:
```bash
# Count non-comment, non-empty lines with fewer than 2 dots (should be 0)
grep -v '^#' data/packages/flatpak-post.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l

# Verify TogglDesktop is removed
grep -i 'toggl' data/packages/flatpak-post.txt | grep -v '^#' | wc -l

# Verify Workflow is removed
grep -i 'workflow' data/packages/flatpak-post.txt | grep -v '^#' | wc -l

# Count total valid entries (should be ~47, was 49 minus 2 removed)
grep -v '^#' data/packages/flatpak-post.txt | grep -v '^$' | wc -l
```
  </verify>
  <done>All non-comment lines in flatpak-post.txt contain at least 2 dots (valid reverse-DNS). TogglDesktop and Workflow entries removed. Total ~47 valid entries remain.</done>
</task>

</tasks>

<verification>
Run full DATA requirement verification:

```bash
# DATA-01: No short names in flatpak.txt
echo "=== DATA-01 ==="
SHORT=$(grep -v '^#' data/packages/flatpak.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l)
echo "Short names in flatpak.txt: $SHORT (expect 0)"

# DATA-02: No short names in flatpak-post.txt
echo "=== DATA-02 ==="
SHORT=$(grep -v '^#' data/packages/flatpak-post.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l)
echo "Short names in flatpak-post.txt: $SHORT (expect 0)"

# DATA-03: Discontinued apps removed
echo "=== DATA-03 ==="
TOGGL=$(grep -i 'toggl' data/packages/flatpak-post.txt | grep -v '^#' | wc -l)
SKYPE=$(grep -i 'skype' data/packages/flatpak.txt | grep -v '^#' | wc -l)
WORKFLOW=$(grep -i 'cunidev.*Workflow' data/packages/flatpak-post.txt | grep -v '^#' | wc -l)
echo "TogglDesktop entries: $TOGGL (expect 0)"
echo "Skype entries: $SKYPE (expect 0)"
echo "Workflow entries: $WORKFLOW (expect 0)"
```
</verification>

<success_criteria>
1. `grep -v '^#' data/packages/flatpak.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l` returns 0
2. `grep -v '^#' data/packages/flatpak-post.txt | grep -v '^$' | awk -F. 'NF<3' | wc -l` returns 0
3. No `toggl`, `skype`, or `cunidev.Workflow` entries (non-comment) in either file
4. All previously-correct entries preserved unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/15-data-compatibility-fixes/15-01-SUMMARY.md`
</output>
