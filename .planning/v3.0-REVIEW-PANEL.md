# Review Panel: v3.0 Quality & Parity

**Date:** 2026-02-19
**Reviewers:** 5 specialist agents (Windows, Linux, macOS, IT Architect, OSS Maintainer)
**Scope:** Full codebase evaluation post-milestone v3.0

---

## Notas por Especialista

| Especialista | Nota | Foco |
|-------------|:----:|------|
| Windows/PowerShell | 8.0 | Modules, WinGet, parity, CmdletBinding |
| Linux/Shell | 7.5 | Bash quality, APT, idempotency, security |
| macOS | 7.5 | Homebrew, Bash 3.2, dotfiles, terminal |
| Senior IT Architect | 8.0 | Arquitetura, ADRs, seguranca, cross-platform |
| OSS Maintainer | 8.0 | Repo health, README, benchmarks, community |
| **Media** | **7.8** | |

---

## Issues Convergentes (citados por 2+ especialistas)

| Issue | Quem citou | Severidade |
|-------|-----------|:----------:|
| `exit 0` universal mascara falhas criticas | Windows, Linux, Architect | ALTA |
| `curl \| sh` sem hash verification | Linux, Architect | ALTA |
| Cobertura de testes ~50% dos core modules | Windows, Linux, macOS, Architect | MEDIA |
| Testes puramente estaticos (sem integration) | Windows, Architect | MEDIA |
| `set -o pipefail` inconsistente | Architect | MEDIA |
| Flatpak IDs incorretos (falha em runtime) | Linux | ALTA |
| Bash 3.2 bloqueado no macOS stock | macOS | MEDIA |
| Falta SECURITY.md | OSS Maintainer | BAIXA |
| Falta demo GIF/screenshot | OSS Maintainer | BAIXA |

---

## TOP Melhorias Consolidadas (por frequencia + severidade)

### Prioridade ALTA

1. **Exit codes semanticos** — `exit 1` quando `FAILURE_LOG` nao vazio (3 votos: Windows, Linux, Architect)
   - Trocar `exit 0` por `exit 1` em `setup.sh` e orchestrators quando ha falhas
   - Definir codigos: 0=sucesso, 1=falha parcial, 2=falha critica pre-flight
   - Refinamento do ADR-001, ~10 linhas

2. **Flatpak IDs completos** — corrigir `flatpak.txt` com IDs reais (Linux)
   - Nomes curtos como `slack`, `zoom`, `vim.vim` vao falhar em runtime
   - Substituir por IDs completos: `com.slack.Slack`, `us.zoom.Zoom`, etc.
   - Esforco baixo, impacto imediato

3. **curl | sh sem hash verification** — documentar risco ou implementar verify (2 votos: Linux, Architect)
   - Afeta: rustup, cargo-binstall, fnm, uv, ollama
   - Minimo: documentar trade-off em ADR
   - Ideal: download -> sha256 verify -> execute

### Prioridade MEDIA

4. **Testes: expandir cobertura** — platform.sh, dotfiles.sh, progress.sh (4 votos)
   - Apenas 4 de 8 core modules tem testes bats
   - Adicionar integration test basico com `--dry-run`
   - Contract tests para paridade Bash/PowerShell (5 pares de modulos)

5. **Bash 3.2 no macOS** — warn em vez de block (macOS)
   - `verify_bash_version()` rejeita Bash < 4.0, mas macOS stock e 3.2
   - Primeiro boot no macOS trava antes de instalar Homebrew
   - Solucao: warn + continue para macOS (main.sh ja faz isso)

6. **`set -o pipefail` universal** — adicionar em todos os scripts executados como subshell (Architect)
   - CONVENTIONS.md diz "every script" mas apenas setup.sh tem
   - Nenhum installer ou orchestrator tem
   - ~12 linhas de adicao

### Prioridade BAIXA

7. **OSS health quick wins** — SECURITY.md + GitHub Releases (OSS Maintainer)
   - SECURITY.md eleva community health score para ~100%
   - GitHub Releases a partir das 31 tags existentes
   - Demo GIF com asciinema + agg (placeholder ja no README)

8. **Correcoes menores por especialista:**
   - Windows: ValidateSet no -Profile, Test-CargoInstalled multiline-safe
   - macOS: Rosetta 2 check, node conflict (brew vs fnm), fzf em brew.txt
   - Linux: check_internet sem google.com, snap lock handling
   - Architect: export -f de funcoes privadas, TEMP_DIR cleanup

---

## Detalhes por Especialista

### Windows Specialist (8.0/10)

**Pros:** Arquitetura modular exemplar, paridade Unix bem executada, WinGet-first strategy para cargo, terminal-setup.ps1 standalone robusto, CmdletBinding correto, 50+ test assertions.

**Top 3 melhorias:**
1. Corrigir exit code em erro fatal no setup.ps1 (exit 0 -> exit 1)
2. Test-CargoInstalled multiline-safe (regex fix)
3. ValidateSet no parametro -Profile

### Linux Specialist (7.5/10)

**Pros:** Separacao de responsabilidades excelente, quoting correto em toda a base, robustez APT (DPkg::Lock::Timeout, retry_with_backoff), source guards em todos os modulos, cargo-binstall fast-path.

**Top 3 melhorias:**
1. Corrigir Flatpak app IDs no data file (falha garantida em runtime)
2. Testes para platform.sh e dotfiles.sh
3. Mitigar risco dos curl | sh (documentar ou verificar hash)

### macOS Specialist (7.5/10)

**Pros:** Deteccao Apple Silicon correta, Homebrew idempotente, dotfiles de alta qualidade (zshrc, path.sh, plugins.sh), terminal blueprint com 3 presets e migracao p10k.

**Top 3 melhorias:**
1. Corrigir bloqueio Bash 3.2 (warn em vez de block)
2. Rosetta 2 + font cask no fluxo
3. Resolver conflito node (brew vs fnm), adicionar fzf

### Senior IT Architect (8.0/10)

**Pros:** Separacao code/data exemplar (ADR-003), module system Bash robusto (ADR-002), error handling bem fundamentado (ADR-001), idempotencia multi-camada (ADR-007), ADRs de qualidade profissional.

**Top 3 melhorias:**
1. Exit codes com significado semantico (refinar ADR-001)
2. Contract tests para paridade Bash/PowerShell (5 pares)
3. `set -o pipefail` universal + integration test basico

### OSS Maintainer (8.0/10)

**Pros:** Community health 85% (superior a todos os benchmarks incluindo mathiasbynens 31K stars), README 9/10, documentacao nivel enterprise, unico projeto cross-platform com testes no ecossistema.

**Top 3 melhorias:**
1. SECURITY.md (eleva community health para ~100%)
2. GitHub Releases a partir das tags existentes
3. Demo GIF com asciinema + agg

---

## Benchmark Comparativo (OSS Maintainer)

| Criterio | os-postinstall | thoughtbot/laptop | mathiasbynens | holman | webpro | cowboy |
|----------|:-:|:-:|:-:|:-:|:-:|:-:|
| Stars | 10 | 8,549 | 31,231 | 7,664 | 1,202 | 1,599 |
| Community Health % | **85%** | 75% | 42% | 42% | 28% | 42% |
| README quality | **9/10** | 7/10 | 6/10 | 7/10 | 8/10 | 6/10 |
| Docs depth | **9/10** | 5/10 | 3/10 | 4/10 | 5/10 | 3/10 |
| Platforms | **3** | 1 | 1 | 1 | 1 | 2 |
| Tests | **37+lint** | 0 | 0 | 0 | Makefile | 0 |
| ADRs | **7** | 0 | 0 | 0 | 0 | 0 |
| Topics | **20** | 0 | 3 | 3 | 12 | 0 |

---

*Review panel: 2026-02-19*
*Input for next milestone planning*
