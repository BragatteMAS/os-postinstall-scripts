# Milestone v4.1: Production Ready

**Status:** SHIPPED 2026-02-22
**Phases:** 15-18
**Total Plans:** 9

## Overview

Production-ready milestone focused on robustness, security, tests, and OSS health. Fixed data integrity issues, added semantic exit codes, expanded test coverage from 37 to 142 tests, and prepared the project for external contributors with SECURITY.md, Apache 2.0 license, and fork-ready documentation.

## Phases

### Phase 15: Data & Compatibility Fixes
**Goal**: Fix broken Flatpak IDs, remove discontinued apps, resolve Bash 3.2 chicken-and-egg on macOS, add pipefail to all scripts, and apply minor convergent fixes
**Depends on**: Phase 14
**Requirements**: DATA-01, DATA-02, DATA-03, COMPAT-01, QUAL-01, QUAL-02
**Plans**: 2 plans

Plans:
- [x] 15-01-PLAN.md -- Fix Flatpak IDs and remove discontinued apps (flatpak.txt, flatpak-post.txt)
- [x] 15-02-PLAN.md -- Bash 3.2 warn-not-block, pipefail in all subshell scripts, PS ValidateSet, brew.txt fixes

### Phase 16: Exit Codes & Security
**Goal**: Replace universal `exit 0` with semantic exit codes (0/1/2), propagate through parent-child chain, add download-then-execute helper for curl|sh, document trust model in ADR-009
**Depends on**: Phase 15
**Requirements**: EXIT-01, EXIT-02, SEC-01, SEC-02
**Plans**: 2 plans

Plans:
- [x] 16-01-PLAN.md -- Exit code constants, compute_exit_code(), cleanup refactor, all child/parent semantic exits, ADR-001 amendment
- [x] 16-02-PLAN.md -- safe_curl_sh() helper, 5 curl|sh migrations, ADR-009

### Phase 17: Test Expansion - Bash
**Goal**: Expand bats coverage from 37 to ~100+ tests covering the 4 untested core modules (platform, progress, dotfiles, interactive), add profile validation tests, integration tests, and Bash/PS contract parity file
**Depends on**: Phase 16
**Requirements**: TEST-03, TEST-04, TEST-05, TEST-06, TEST-07, TEST-08, TEST-09
**Plans**: 3 plans

Plans:
- [x] 17-01-PLAN.md -- Unit tests for platform.sh, progress.sh, and interactive.sh (36 tests)
- [x] 17-02-PLAN.md -- Unit tests for dotfiles.sh and data validation tests (28 tests)
- [x] 17-03-PLAN.md -- Integration tests for setup.sh CLI and Bash/PS contract parity file (12 tests)

### Phase 18: Polish & OSS Health
**Goal**: Add Pester unit tests for PowerShell modules, create SECURITY.md, format GitHub Releases, and produce demo GIF for README
**Depends on**: Phase 17
**Requirements**: TEST-10, OSS-01, OSS-02, OSS-03
**Plans**: 2 plans

Plans:
- [x] 18-01-PLAN.md -- Pester unit tests for logging, errors, packages, progress modules (22 tests)
- [x] 18-02-PLAN.md -- SECURITY.md, GitHub Release v4.0.0, improved README demo placeholder

## Milestone Summary

**Key Decisions:**
- Semantic exit codes (0/1/2) replace universal exit 0 (ADR-001 amended)
- safe_curl_sh() download-then-execute pattern for all curl|sh sites (ADR-009)
- NO_COLOR=1 simplifies Pester Write-Host mock assertions
- Pester v5 module-scoped mocking requires -ModuleName parameter
- Apache 2.0 license (from MIT) for attribution requirements
- Git submodules for bats-core test framework (portability over Homebrew)

**Issues Resolved:**
- 36 broken Flatpak IDs fixed (reverse-DNS format)
- Bash 3.2 chicken-and-egg on macOS (warn-not-block)
- EXIT trap bug (cleanup() now preserves non-zero exit codes)
- Pester v5 module-scoped mocking failures (8/22 tests fixed)
- Documentation gaps for forkers (submodules, test instructions, Pester prereqs)
- SECURITY.md vs README vulnerability reporting contradiction

**Issues Deferred:**
- Terminal demo GIF (asciinema + agg) -- placeholder with realistic CLI output used instead
- Social preview image via socialify.git.ci
- CHANGELOG v4.x entries

**Technical Debt Incurred:**
- DATA_DIR fallback path in linux/main.sh and macos/main.sh uses wrong relative path (dead code, unreachable)

---

_For current project status, see .planning/ROADMAP.md_
